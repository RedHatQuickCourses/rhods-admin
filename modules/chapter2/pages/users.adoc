= Users and Permissions

== Logging Into Openshift.AI

Openshift.AI utilizes OpenShift OAuth as the authentication method for all Openshift.AI related resources.  When attempting to log into the Openshift.AI Dashboard or other UI components, users will be presented with a page prompting them to `Log in with OpenShift`.

image::login-with-openshift.png[]

By default, any user with the ability to login to OpenShift will be able to access the Openshift.AI Dashboard.

[TIP]
====

For assistance with configuring user access to OpenShift with various identity providers, please refer to the official https://docs.openshift.com/container-platform/4.13/post_installation_configuration/preparing-for-users.html[Preparing for users] OpenShift documentation.

====

== Admin Access

By default, users with the `cluster-admin` role are automatically granted admin permissions in the Openshift.AI Dashboard.  Additional, a group called `Openshift.AI-admins` is automatically created, and any user added to that group will be granted admin permissions.

Admin access in the Openshift.AI Dashboard allows users to control various settings of Openshift.AI through the Dashboard UI, including:

- Configuring custom notebook images
- Configuring custom serving runtimes
- Configuring the idle notebook culler
- Other notebook configuration settings

To add users to the `Openshift.AI-admins` group, run the following command:

```sh
oc adm groups add-users Openshift.AI-admins my-user1 my-user2
```

== Updating Default User Permissions

The default permissions for the Openshift.AI Dashboard can be updated through the `Settings`>`User management` section.

image::user-management.png[]

The admin group can be updated to another group other than the default `Openshift.AI-admins` group, such as one that is configured to sync with an external system.  Additionally, admin permissions to the Dashboard are always granted to users assigned the 
cluster-admin ClusterRole.

[TIP]
====

It is highly recommended that dedicated admin users are configured for Openshift.AI and that organizations do not rely on the `cluster-admin` role for exclusive permissions to admin configurations of Openshift.AI.  Dedicated Admin users should be added to the existing `Openshift.AI-admins` group, or another group which already contains the correct users should be configured in lieu of the `Openshift.AI-admins` group.

====

The normal Data Science user group can also be updated to change what users are able to sign into the Openshift.AI Dashboard.  By default, the Dashboard is configured to allow all authenticated users with the `system:authenticated` role.  A custom group can be configured to allow only specific users belonging to that group to access the Dashboard.

[WARNING]
====

Updating the access in the `User and group settings` in the Dashboard will only impact a users abilities to access the Dashboard, and will not impact any permissions granted by regular Kubernetes based RBAC.  

For example, if the normal user group is updated to only allow specific users to access the Dashboard, and a user that is not part of that group has admin may still have the ability to create Data Science related objects such as Notebooks, Data Science Pipelines, or Model Servers in a namespace they have permission in using the associated k8s objects without the UI.

====

=== Managing Dashboard Permissions with GitOps

The `User and group settings` in the Openshift.AI Dashboard can also be managed using the `OdhDashboardConfigs` objected called `odh-dashboard-config` located in the redhat-ods-applications namespace along with many of the other settings found in the Dashboard's Settings section:

```sh
oc get odhdashboardconfigs odh-dashboard-config -n redhat-ods-applications -o yaml
```

A truncated version of the OdhDashboardConfig object with the groupConfig settings can be found below:

```yaml
apiVersion: opendatahub.io/v1alpha
kind: OdhDashboardConfig
metadata:
  name: odh-dashboard-config
  namespace: redhat-ods-applications
spec:
  groupsConfig:
    adminGroups: Openshift.AI-admins
    allowedGroups: 'system:authenticated'
```

== Data Science Project Permissions

The Openshift.AI Dashboard permits users of the Dashboard to create new Data Science Projects when self-provisioning is enabled on the cluster:

image::create-datascience-project.png[]

[TIP]
====

For information on how to disable self-provisioner on OpenShift refer to the official https://docs.openshift.com/container-platform/4.13/applications/projects/configuring-project-creation.html#disabling-project-self-provisioning_configuring-project-creation[Disabling project self-provisioning] OpenShift documentation.

====

When a user creates a new Data Science Project through the Dashboard, the Dashboard will create a corresponding OpenShift Project and Kubernetes Namespace.  The user who created the Data Science Project will automatically be granted admin permissions to the Namespace.

=== Managing Permissions on a Data Science Project

A Data Science Project is nothing more than a normal OpenShift Project with a few special labels.  As such, permissions to the project function the same as any other project/namespace in OpenShift.

Users can be granted permissions to the Project using traditional RBAC configuration.

Additionally, the Dashboard provides a user interface that will allow Admins on the project to easily apply `edit` or `admin` access to other users or groups.  The Permissions view can be access by navigating to a specific project under the Data Science Projects menu, and selecting the Permissions tab.

image::datascience-project-permissions.png[]

[NOTE]
====

The Dashboard Permissions user interface only displays users and groups that were granted permissions directly through the Dashboard.  Any users or groups that have been granted permission to the Project by manually creating RoleBindings on the project or who are granted higher level cluster permissions will not be displayed in the user interface.

====
