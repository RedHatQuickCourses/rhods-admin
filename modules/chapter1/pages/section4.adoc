= Upgrading Red{nbsp}Hat Openshift Data Science

*Red{nbsp}Hat Openshift Data Science* operator supports _seamless upgrades_, hence patches and minor version upgrades are completely managed by the *OLM*.

[IMPORTANT]
Upgrading directly from the Red Hat OpenShift Data Science self-managed Beta version to the Generally Available (GA) release is not supported. The operator has to be uninstalled first and replaced with the new version.

When an upgrade is available *OLM* creates an *Installplan* for the new version. 

[subs=+quotes]
----
*$ oc get installplan -n redhat-ods-operator*
NAME            CSV                    APPROVAL   APPROVED
install-sp49w   rhods-operator.2.2.0   Manual     false   <1>
install-w6lqv   rhods-operator.2.1.0   Manual     true    <2>
----
<1> *Installplan* for the new version of the operator which has not been approved yet. It has to be approved in order to start the upgrade.
<2> *Installplan* for the currently installed version. It's been approved and the version is currently installed.


Installplan is approved either automatically when a new version is available without user's intervention or requires a manual approval. Whether the approval is automatic or manual depends on the value of the xref:section3.adoc#subscription[installPlanApproval] attribute of the operator's subscription. When it is set to _Automatic_ the *installplan* is approved automaticaly and installation starts without user's intervention. _Manual_ value requires a manual approval.

Approvals can be set from the web console as well as from the CLI.

Manual approvals done from the CLI are discussed in the xref:section3.adoc#manual_approval[Approving Installation Manualy] section and are exactly the same as for the installation.

The following demonstration shows a manual approval done from the web console. 

== Demo: Upgrading Red{nbsp}Hat Openshift Data Science
1. Log in to Red{nbsp} Openshift web console using a user which has _cluster-admin_ role assigned.
2. Navigate to *Operators* -> *Installed Operators* and select project *redhat-ods-operator*. You should see *Upgrade available* under the *Status* column.
+
image::rhods2-upgrade-available.png[width=800]

3. Click on the *Upgrade available* status link to open operator's *Install plan*
+
image::rhods2-upgrade-install-plan.png[width=800] 

4. Click on the *Preview InstallPlan* button to review changes made by the upgrade.
+
image::rhods2-upgrade-preview.png[width=800]

5. Click on the *Approve* button to approve and start the upgrade and navigate to *Operators* -> *Installed Operators* to view the upgrade status.
+
image::rhods2-upgrade-status.png[width=800]

6. Wait until the *Status* changes to *Succeeded*
+
image::rhods2-upgrade-succeeded.png[width=800]

== Backup considerations
Permanent storage for *Jupiter notebooks* is done using Openshift *Persistent Volume Claims (PVC)* attached to the *Jupiter notebook* pod. The operator does manage PVCs hence there is no need to take a backup as long as the Openshift *Namespace* where the *Jupiter notebook* pod is running is not deleted. Even in an event of accidental operator uninstallation all namespaces created by either the operator or a *Red{nbsp}Hat Openshift Data Science* user remain untouched.
