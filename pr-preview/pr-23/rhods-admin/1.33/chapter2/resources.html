<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Managing Resources :: Red Hat OpenShift Data Science Administration</title>
    <link rel="prev" href="users.html">
    <link rel="next" href="../chapter3/index.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Red Hat OpenShift Data Science Administration</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/rhods-admin/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="rhods-admin" data-version="1.33">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Red Hat OpenShift Data Science Administration</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter1/index.html">Installation of Red&#160;Hat OpenShift AI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/install-general-info.html">General Information about Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/dependencies-install-web-console.html">Installing Dependencies Using the Web Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/rhods-install-web-console.html">Installing Red&#160;Hat OpenShift AI Using the Web Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/upgrading-rhods.html">Upgrading Red&#160;Hat OpenShift AI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/uninstalling-rhods.html">Uninstalling Red&#160;Hat OpenShift AI</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Controlling User Access and Managing Resources</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="users.html">Users, Projects, and Permissions</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="resources.html">Managing Resources</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter3/index.html">Building Custom Notebook Images</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/custom.html">Create a Custom Notebook Image</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/importcustom.html">Importing Custom Notebook Images</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Red Hat OpenShift Data Science Administration</span>
    <span class="version">1.33</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Red Hat OpenShift Data Science Administration</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.33</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Red Hat OpenShift Data Science Administration</a></li>
    <li><a href="index.html">Controlling User Access and Managing Resources</a></li>
    <li><a href="resources.html">Managing Resources</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Managing Resources</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>OpenShift AI allows for end users to create many different types of resources as part of the development and deployment process.  This section will review the different types of resources users are able to create in OpenShift AI and how to manage them.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kubernetes_resources"><a class="anchor" href="#_kubernetes_resources"></a>Kubernetes Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The majority of actions taken in the OpenShift AI will create a kubernetes object based on that action.  This section will discussion the different components supported by OpenShift AI and the different resources they create or interact with.</p>
</div>
<div class="sect2">
<h3 id="_data_science_projects"><a class="anchor" href="#_data_science_projects"></a>Data Science Projects</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">OpenShift AI Resource Name</th>
<th class="tableblock halign-left valign-top">Kubernetes Resource Name</th>
<th class="tableblock halign-left valign-top">Custom Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Science Project</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">projects.project.openshift.io</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Data Science Project is synonym with an OpenShift Project or a Namespace.  See the users section for more information on how to create and manage Data Science Projects</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">users.user.openshift.io</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A user is an object that corresponds to a specific user that can be granted permissions within OpenShift.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Groups</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">groups.user.openshift.io</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A group is a collection of users that like users, can be granted permissions within OpenShift.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permissions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rolebindings.rbac.authorization.k8s.io</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Users and Groups are granted permission to a Data Science Project via a RoleBinding.  RoleBindings associate the user or group with a specific Kubernetes Role.  Only the Edit and Admin roles are available within the Dashboard.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_notebook_controller"><a class="anchor" href="#_notebook_controller"></a>Notebook Controller</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">OpenShift AI Resource Name</th>
<th class="tableblock halign-left valign-top">Kubernetes Resource Name</th>
<th class="tableblock halign-left valign-top">Custom Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Workbench</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">notebooks.kubeflow.org</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A workbench is a IDE running in a pod using the Kubeflow Notebook Controller.  Workbenches can run a number of web based IDEs including JupyterLab, VSCode, and R Studio, depending on what IDE was built into the workbench image.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cluster Storage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">persistentvolumeclaims</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Workbenches utilize cluster storage to persist a users environment when the workbench pod is not running.  When creating a workbench a default cluster storage instance will be created automatically to store any code or files a user creates in the workbench.  Additional cluster storage can be added to the workbench for things like a dedicated PVC for training data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Connection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">secrets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A data connection is a secret that includes fields required to connect to an S3 bucket.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_data_science_pipelines"><a class="anchor" href="#_data_science_pipelines"></a>Data Science Pipelines</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">OpenShift AI Resource Name</th>
<th class="tableblock halign-left valign-top">Kubernetes Resource Name</th>
<th class="tableblock halign-left valign-top">Custom Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Science Pipeline Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">datasciencepipelinesapplications.datasciencepipelinesapplications.opendatahub.io</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DSPA&#8217;s create an instance of Data Science Pipelines.  DSPA&#8217;s require a data connection and an S3 bucket to create the instance.  DSPA&#8217;s are namespace scoped to prevent leaking data across multiple projects.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pipelines</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When developing a pipeline, depending on the tool, users may generate a YAML based PipelineRun object that is then uploaded into the Dashboard to create an executable pipeline.  Even though this yaml object is a valid Tekton PipelineRun it is intended to be uploaded to the Dashboard, and not applied directly to the cluster.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pipeline Runs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pipelineruns.tekton.dev</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A pipeline can be executed in a number of different ways, including from the Dashboard, which will result in the creation of a pipelinerun.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_model_mesh"><a class="anchor" href="#_model_mesh"></a>Model Mesh</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">OpenShift AI Resource Name</th>
<th class="tableblock halign-left valign-top">Kubernetes Resource Name</th>
<th class="tableblock halign-left valign-top">Custom Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Model Server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">servingruntimes.serving.kserve.io</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A model server is used to create a pod to serve models.  A single model server can serve multiple models from a single instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Models</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inferenceservices.serving.kserve.io</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Models are associated with a specific model server, from which an endpoint will be created.  Models require a data connection and a location where the model file is stored in the s3 bucket.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_idle_notebook_culling"><a class="anchor" href="#_configuring_idle_notebook_culling"></a>Configuring Idle Notebook Culling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Notebooks or Workbenches are intended to be user interactive development environments.  Often times they can consume a large number of compute, memory, or GPU resources, and users may forget to shut them off when they are finished working with them, which can lead to issues where clusters begin to run out of available resources if not cleaned up.</p>
</div>
<div class="paragraph">
<p>The Idle Notebook Culler is intended to help reduce the number of inactive notebooks running on the cluster, by detecting the last time an action was taken in a notebook and shutting down the pods if the notebook has been inactive for a period of time.</p>
</div>
<div class="paragraph">
<p>An admin can enable culling for notebooks though the Dashboard under the menu:Settings[Cluster settings] section:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/idle-notebook-culling.png" alt="idle notebook culling">
</div>
</div>
<div class="paragraph">
<p>Alternatively, the idle notebook culling can be configured by creating the following config map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>kind: ConfigMap
apiVersion: v1
metadata:
  name: notebook-controller-culler-config <i class="conum" data-value="1"></i><b>(1)</b>
  namespace: redhat-ods-applications <i class="conum" data-value="2"></i><b>(2)</b>
  labels:
    opendatahub.io/dashboard: 'true'
data:
  CULL_IDLE_TIME: '240' <i class="conum" data-value="3"></i><b>(3)</b>
  ENABLE_CULLING: 'true' <i class="conum" data-value="4"></i><b>(4)</b>
  IDLENESS_CHECK_PERIOD: '1' <i class="conum" data-value="5"></i><b>(5)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The name of the config map, which must match <code>notebook-controller-culler-config</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The namespaces where the Dashboard is installed</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The time an notebook is idle before it is automatically stopped (in minutes)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>An option to enable or disable the automatic culling</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>How frequently the culler will check if the notebook is idle (in minutes)</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A notebook is considered idle when the user has not taken any action inside of the notebook such as executing a cell, creating files, or interacting with the user interface in general.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_managing_workbench_and_model_server_sizes"><a class="anchor" href="#_managing_workbench_and_model_server_sizes"></a>Managing Workbench and Model Server Sizes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When launching Workbenches or Model Servers from the Dashboard, users are presented with several default sizes they can select from.  The default options may not suit your organizations needs</p>
</div>
<div class="listingblock">
<div class="content">
<pre>apiVersion: opendatahub.io/v1alpha
kind: OdhDashboardConfig
metadata:
  annotations:
    internal.config.kubernetes.io/previousKinds: OdhDashboardConfig
    internal.config.kubernetes.io/previousNames: odh-dashboard-config
    internal.config.kubernetes.io/previousNamespaces: default
  name: odh-dashboard-config <i class="conum" data-value="1"></i><b>(1)</b>
  namespace: redhat-ods-applications <i class="conum" data-value="2"></i><b>(2)</b>
  labels:
    app.kubernetes.io/part-of: rhods-dashboard
    app.opendatahub.io/rhods-dashboard: 'true'
spec:
  dashboardConfig:
    modelMetricsNamespace: ''
    enablement: true
    disableProjects: false
    disableSupport: false
    disablePipelines: false
    disableProjectSharing: false
    disableModelServing: false
    disableCustomServingRuntimes: false
    disableISVBadges: false
    disableUserManagement: false
    disableInfo: false
    disableClusterManager: false
    disableBYONImageStream: false
    disableTracking: false
  groupsConfig:
    adminGroups: rhods-admins
    allowedGroups: 'system:authenticated'
  modelServerSizes: <i class="conum" data-value="3"></i><b>(3)</b>
    - name: Small
      resources:
        limits:
          cpu: '2'
          memory: 8Gi
        requests:
          cpu: '1'
          memory: 4Gi
    - name: Medium
      resources:
        limits:
          cpu: '8'
          memory: 10Gi
        requests:
          cpu: '4'
          memory: 8Gi
    - name: Large
      resources:
        limits:
          cpu: '10'
          memory: 20Gi
        requests:
          cpu: '6'
          memory: 16Gi
  notebookController:
    enabled: true
    notebookNamespace: rhods-notebooks
    notebookTolerationSettings:
      enabled: false
      key: NotebooksOnly
    pvcSize: 20Gi
  notebookSizes: <i class="conum" data-value="4"></i><b>(4)</b>
    - name: Small
      resources:
        limits:
          cpu: '2'
          memory: 8Gi
        requests:
          cpu: '1'
          memory: 8Gi
    - name: Medium
      resources:
        limits:
          cpu: '6'
          memory: 24Gi
        requests:
          cpu: '3'
          memory: 24Gi
    - name: Large
      resources:
        limits:
          cpu: '14'
          memory: 56Gi
        requests:
          cpu: '7'
          memory: 56Gi
    - name: X Large
      resources:
        limits:
          cpu: '30'
          memory: 120Gi
        requests:
          cpu: '15'
          memory: 120Gi
  templateOrder: []</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The name of the OdhDashboardConfig, which must match <code>odh-dashboard-config</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The namespaces where the Dashboard is installed</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The default model server sizes, provided as a list</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The default workbench sizes, provided by a list</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Users will most often select the largest option available to them, despite what their actual needs are.  Customizing these options based on the kinds of use cases your organization typically tackles can help to reduce the overall consumption of resources on a cluster.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>OpenShift provides the ability to restrict how many resources, including CPU, memory, and GPUs, are consumed by each project on a cluster with a LimitRange. To learn more about these capabilities refer to the
<a href="https://docs.openshift.com/container-platform/4.14/nodes/clusters/nodes-cluster-limit-ranges.html">Restrict resource consumption with limit ranges</a> documentation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_removing_an_unused_project"><a class="anchor" href="#_removing_an_unused_project"></a>Removing an Unused Project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Over time, projects may become abandoned as users leave your organization or move onto other initiatives. Old projects may need to be cleaned up and removed from the cluster in order to free up those resources.</p>
</div>
<div class="paragraph">
<p>To completely remove a project from OpenShift, you must first delete all of the resources from that project before you will be able to delete the project.</p>
</div>
<div class="paragraph">
<p>The following <code>oc</code> commands can be used to help cleanup OpenShift AI related resources prior to deleting the project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh"># select the project
oc project my-project

# delete any workbenches
oc delete notebooks --all
# delete any models and model servers
oc delete inferenceservices,servingruntimes --all
# delete any data science pipeline instances
oc delete dspa,pipelineruns --all

# cleanup any other non OpenShift AI resources deployed in the project

# delete any other common objects
oc delete pvc,configmaps,secrets,rolebindings,roles --all

# delete the project
oc delete project my-project</code></pre>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="users.html">Users, Projects, and Permissions</a></span>
  <span class="next"><a href="../chapter3/index.html">Building Custom Notebook Images</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
